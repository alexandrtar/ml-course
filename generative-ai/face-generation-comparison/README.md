# ๐ญ Face Generation Comparison: GAN vs VAE

## ๐ ะัััััะน ััะฐัั

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ะธ ัััะฐะฝะพะฒะบะฐ

```bash
# ะะปะพะฝะธััะนัะต ะฟัะพะตะบั
git clone <ะฒะฐั-ัะตะฟะพะทะธัะพัะธะน>
cd face-generation-comparison

# ะกะพะทะดะฐะนัะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต
conda create -n tf-gpu-env python=3.10
conda activate tf-gpu-env

# ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ
pip install -r requirements.txt
```
### 2. ะะฑััะตะฝะธะต ะผะพะดะตะปะตะน

```bash
# ะะฑััะธัะต ะฒัะต ะผะพะดะตะปะธ
python train_models.py --model=all --max-images=5000

# ะะปะธ ะพะฑััะธัะต ะฟะพ ะพัะดะตะปัะฝะพััะธ
python train_models.py --model=gan
python train_models.py --model=vae
```
### 3. ะะฐะฟััะบ ัะธััะตะผั

```bash
# ะกะฟะพัะพะฑ 1: ะะฒัะพะผะฐัะธัะตัะบะธะน ะทะฐะฟััะบ ะฒัะตะน ัะธััะตะผั
python start_system.py

# ะกะฟะพัะพะฑ 2: ะััะฝะพะน ะทะฐะฟััะบ ะฒ ะดะฒัั ะพะบะฝะฐั
# ะขะตัะผะธะฝะฐะป 1: API ัะตัะฒะตั
python start_api.py

# ะขะตัะผะธะฝะฐะป 2: ะะตะฑ-ะธะฝัะตััะตะนั
streamlit run web_interface.py
```
## ๐ ะกะธััะตะผะฝัะต ััะตะฑะพะฒะฐะฝะธั

* Python 3.8+

* TensorFlow 2.10+

* GPU ั ะฟะพะดะดะตัะถะบะพะน CUDA (ัะตะบะพะผะตะฝะดัะตััั)

* 8GB+ RAM

* 5GB+ ัะฒะพะฑะพะดะฝะพะณะพ ะผะตััะฐ ะฝะฐ ะดะธัะบะต

## ๐๏ธ ะััะธัะตะบัััะฐ

```text
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ะะตะฑ-ะธะฝัะตััะตะนั (Streamlit)            โ
โ                   http://localhost:8501                  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ
                            โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    API ะกะตัะฒะตั (FastAPI)                 โ
โ                   http://localhost:8000                  โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโ
               โ                            โ
               โผ                            โผ
    โโโโโโโโโโโโโโโโโโโโ          โโโโโโโโโโโโโโโโโโโโ
    โ    GAN Model     โ          โ    VAE Model     โ
    โ  (Generator)     โ          โ (Encoder+Decoder)โ
    โโโโโโโโโโโโโโโโโโโโ          โโโโโโโโโโโโโโโโโโโโ

```
## ๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

```text
face-generation-comparison/
โโโ ๐ app/                    # ะะพะด ะฟัะธะปะพะถะตะฝะธั
โ   โโโ ๐ config/
โ   โ   โโโ settings.py       # ะะฐัััะพะนะบะธ ัะธััะตะผั
โ   โโโ ๐ models/            # ะะพะดะตะปะธ ML
โ   โ   โโโ base_model.py     # ะะฐะทะพะฒัะน ะบะปะฐัั ะผะพะดะตะปะธ
โ   โ   โโโ gan_model.py      # GAN ะผะพะดะตะปั
โ   โ   โโโ vae_model.py      # VAE ะผะพะดะตะปั
โ   โ   โโโ sampling_layer.py # ะะฐััะพะผะฝัะน ัะปะพะน ะดะปั VAE
โ   โ   โโโ fallback_vae.py   # ะะตะทะตัะฒะฝะฐั VAE ะผะพะดะตะปั
โ   โโโ ๐ schemas/
โ   โ   โโโ requests.py       # Pydantic ััะตะผั
โ   โโโ ๐ services/          # ะะธะทะฝะตั-ะปะพะณะธะบะฐ
โ   โ   โโโ generation_service.py # ะกะตัะฒะธั ะณะตะฝะตัะฐัะธะธ
โ   โ   โโโ image_utils.py    # ะฃัะธะปะธัั ะดะปั ะธะทะพะฑัะฐะถะตะฝะธะน
โ   โ   โโโ training_service.py   # ะกะตัะฒะธั ะพะฑััะตะฝะธั
โ   โโโ main.py               # FastAPI ะฟัะธะปะพะถะตะฝะธะต
โโโ ๐ trained_models/        # ะะฑััะตะฝะฝัะต ะผะพะดะตะปะธ
โ   โโโ gan_generator.h5      # ะะฑััะตะฝะฝัะน ะณะตะฝะตัะฐัะพั GAN
โ   โโโ vae_encoder.h5        # ะญะฝะบะพะดะตั VAE
โ   โโโ vae_decoder.h5        # ะะตะบะพะดะตั VAE
โโโ ๐ web_interface.py       # Streamlit ะฒะตะฑ-ะธะฝัะตััะตะนั
โโโ ๐ start_api.py           # ะกะบัะธะฟั ะทะฐะฟััะบะฐ API
โโโ ๐ start_system.py        # ะกะบัะธะฟั ะทะฐะฟััะบะฐ ะฒัะตะน ัะธััะตะผั
โโโ ๐ train_models.py        # ะกะบัะธะฟั ะพะฑััะตะฝะธั ะผะพะดะตะปะตะน
โโโ ๐ requirements.txt       # ะะฐะฒะธัะธะผะพััะธ Python
โโโ ๐ README.md              # ะะพะบัะผะตะฝัะฐัะธั
```
## ๐ง ะขะตัะฝะธัะตัะบะธะน ััะตะบ

### Machine Learning

* TensorFlow 2.10+ - ะณะปัะฑะพะบะพะต ะพะฑััะตะฝะธะต

* Keras - ะฒััะพะบะพััะพะฒะฝะตะฒัะน API

* NumPy - ัะธัะปะตะฝะฝัะต ะฒััะธัะปะตะฝะธั

* Pillow - ะพะฑัะฐะฑะพัะบะฐ ะธะทะพะฑัะฐะถะตะฝะธะน

## Backend & API

* FastAPI - ะฒััะพะบะพะฟัะพะธะทะฒะพะดะธัะตะปัะฝัะน API ัะตัะฒะตั

* Uvicorn - ASGI ัะตัะฒะตั

* Pydantic - ะฒะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั

## Frontend & UI

* Streamlit 1.28+ - ะฒะตะฑ-ะธะฝัะตััะตะนั ะดะปั ML

* Requests - HTTP ะบะปะธะตะฝั ะดะปั API

### ๐ฏ ะัะพะฑะตะฝะฝะพััะธ

## ะะตะฝะตัะฐัะธั ะธะทะพะฑัะฐะถะตะฝะธะน

* GAN: ะััััะฐั ะณะตะฝะตัะฐัะธั ัะฐะทะฝะพะพะฑัะฐะทะฝัั ะปะธั

* VAE: ะะพะปะตะต ะฟะปะฐะฒะฝัะต ะธ ััััะบัััะธัะพะฒะฐะฝะฝัะต ะธะทะพะฑัะฐะถะตะฝะธั

* ะะพะปะธัะตััะฒะพ: ะั 1 ะดะพ 10 ะธะทะพะฑัะฐะถะตะฝะธะน ะทะฐ ัะฐะท

* ะะฐะทัะตัะตะฝะธะต: 64x64 ะฟะธะบัะตะปะตะน

## ะะฝัะตัะฟะพะปััะธั

* ะะปะฐะฒะฝัะต ะฟะตัะตัะพะดั ะผะตะถะดั ะดะฒัะผั ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัะผะธ ะปะธัะฐะผะธ

* ะะฐัััะฐะธะฒะฐะตะผัะต ัะฐะณะธ: ะั 3 ะดะพ 20 ะฟัะพะผะตะถััะพัะฝัั ัะพััะพัะฝะธะน

* ะะธะทัะฐะปัะฝะฐั ัะตัะบะฐ: ะะฒัะพะผะฐัะธัะตัะบะพะต ัะพะทะดะฐะฝะธะต ัะตัะบะธ ะฟะตัะตัะพะดะพะฒ

## API ะญะฝะดะฟะพะธะฝัั

```text
GET  /health         # ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะธััะตะผั
GET  /models         # ะะฝัะพัะผะฐัะธั ะพ ะทะฐะณััะถะตะฝะฝัั ะผะพะดะตะปัั
POST /generate       # ะะตะฝะตัะฐัะธั ะธะทะพะฑัะฐะถะตะฝะธะน
POST /interpolate    # ะะฝัะตัะฟะพะปััะธั ะผะตะถะดั ะปะธัะฐะผะธ
POST /train/gan      # ะะฑััะตะฝะธะต GAN ะผะพะดะตะปะธ
POST /train/vae      # ะะฑััะตะฝะธะต VAE ะผะพะดะตะปะธ
```

## ๐ ะกัะฐะฒะฝะตะฝะธะต GAN ะธ VAE

| ะัะธัะตัะธะน | GAN | VAE |
|---|---|---|
| ะะฐัะตััะฒะพ | ะััะพะบะพะต, ัะตัะบะธะต ะดะตัะฐะปะธ | ะะตะผะฝะพะณะพ ัะฐะทะผัััะต, ะฟะปะฐะฒะฝัะต |
| ะะฐะทะฝะพะพะฑัะฐะทะธะต | ะะพะปััะพะต | ะะณัะฐะฝะธัะตะฝะฝะพะต |
| ะะฝัะตัะฟะพะปััะธั | ะะตะทะบะธะต ะฟะตัะตัะพะดั | ะะปะฐะฒะฝัะต ะฟะตัะตัะพะดั |
| ะะฑััะตะฝะธะต | ะะตััะฐะฑะธะปัะฝะพะต | ะกัะฐะฑะธะปัะฝะพะต |
| ะะฐัะตะฝัะฝะพะต ะฟัะพัััะฐะฝััะฒะพ | ะะตััััะบัััะธัะพะฒะฐะฝะฝะพะต | ะกัััะบัััะธัะพะฒะฐะฝะฝะพะต (ะณะฐัััะพะฒะพ) |

## ๐จ ะฃัััะฐะฝะตะฝะธะต ะฝะตะฟะพะปะฐะดะพะบ

### 1. API ะฝะต ะทะฐะฟััะบะฐะตััั
```bash
# ะัะพะฒะตัััะต ะทะฐะฝััะพััั ะฟะพััะฐ
netstat -ano | findstr :8000

# ะฃััะฐะฝะพะฒะธัะต ะฟัะฐะฒะธะปัะฝัั ะฒะตััะธั protobuf
pip install protobuf==3.20.0
```

### 2. ะะพะดะตะปะธ ะฝะต ะทะฐะณััะถะฐัััั
```bash
# ะัะพะฒะตัััะต ะฝะฐะปะธัะธะต ัะฐะนะปะพะฒ ะผะพะดะตะปะตะน
ls -la trained_models/

# ะะฑััะธัะต ะผะพะดะตะปะธ ะทะฐะฝะพะฒะพ
python train_models.py --model=all
```
### 3. ะะตะฑ-ะธะฝัะตััะตะนั ะฝะต ะพัะพะฑัะฐะถะฐะตั ะธะทะพะฑัะฐะถะตะฝะธั
```bash
# ะัะพะฒะตัััะต ะทะฐะฟััะบ API
curl http://localhost:8000/health

# ะะฑะฝะพะฒะธัะต Streamlit
pip install --upgrade streamlit
```
## ๐ง ะััะธัะตะบัััะฐ ะผะพะดะตะปะตะน
### GAN (Generative Adversarial Network)
```text
ะะตะฝะตัะฐัะพั:
  Input: ะะฐัะตะฝัะฝัะน ะฒะตะบัะพั (256) โ Dense โ Reshape โ Conv2DTranspose (x4) โ Output (64x64x3)

ะะธัะบัะธะผะธะฝะฐัะพั:
  Input: ะะทะพะฑัะฐะถะตะฝะธะต (64x64x3) โ Conv2D (x4) โ Flatten โ Dense โ Output (1)
```
### VAE (Variational Autoencoder)
```text
ะญะฝะบะพะดะตั:
  Input: ะะทะพะฑัะฐะถะตะฝะธะต (64x64x3) โ Conv2D (x3) โ Flatten โ Dense โ z_mean, z_log_var, z (256)

ะะตะบะพะดะตั:
  Input: ะะฐัะตะฝัะฝัะน ะฒะตะบัะพั (256) โ Dense โ Reshape โ Conv2DTranspose (x3) โ Output (64x64x3)
```
## ๐๏ธ ะะพะฝัะธะณััะฐัะธั

ะัะฝะพะฒะฝัะต ะฝะฐัััะพะนะบะธ ะฒ app/config/settings.py:

```python
IMAGE_SIZE = (64, 64)          # ะะฐะทะผะตั ะณะตะฝะตัะธััะตะผัั ะธะทะพะฑัะฐะถะตะฝะธะน
MAX_IMAGES = 5000              # ะะฐะบัะธะผัะผ ะธะทะพะฑัะฐะถะตะฝะธะน ะดะปั ะพะฑััะตะฝะธั

# GAN ะฟะฐัะฐะผะตััั
GAN_LATENT_DIM = 256           # ะะฐะทะผะตัะฝะพััั ะปะฐัะตะฝัะฝะพะณะพ ะฟัะพัััะฐะฝััะฒะฐ GAN
GAN_EPOCHS = 10000             # ะะพะปะธัะตััะฒะพ ัะฟะพั ะพะฑััะตะฝะธั

# VAE ะฟะฐัะฐะผะตััั
VAE_LATENT_DIM = 256           # ะะฐะทะผะตัะฝะพััั ะปะฐัะตะฝัะฝะพะณะพ ะฟัะพัััะฐะฝััะฒะฐ VAE
VAE_EPOCHS = 100               # ะะพะปะธัะตััะฒะพ ัะฟะพั ะพะฑััะตะฝะธั

# API ะฟะฐัะฐะผะตััั
API_HOST = "0.0.0.0"           # ะฅะพัั API ัะตัะฒะตัะฐ
API_PORT = 8000                # ะะพัั API ัะตัะฒะตัะฐ
```

## ๐ ะัะฟะพะปัะทะพะฒะฐะฝะฝัะต ัะตัะฝะพะปะพะณะธะธ ะธ ะธััะปะตะดะพะฒะฐะฝะธั

* ะัะธะณะธะฝะฐะปัะฝะฐั ััะฐััั GAN: Goodfellow et al., 2014

* ะัะธะณะธะฝะฐะปัะฝะฐั ััะฐััั VAE: Kingma & Welling, 2013

* ะะฐะฑะพั ะดะฐะฝะฝัั: LFW (Labeled Faces in the Wild)

* ะััะธัะตะบัััั: DCGAN ะดะปั GAN, ััะฐะฝะดะฐััะฝะฐั VAE

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

* ะคะพัะบะฝะธัะต ัะตะฟะพะทะธัะพัะธะน

* ะกะพะทะดะฐะนัะต ะฒะตัะบั ะดะปั ะฝะพะฒะพะน ััะฝะบัะธะธ

* ะะฐัะธะบัะธััะนัะต ะธะทะผะตะฝะตะฝะธั

* ะัะฟัะฐะฒััะต pull request

## ๐ ะะธัะตะฝะทะธั
MIT License

## โ๏ธ ะะฒัะพั
ะะปะตะบัะฐะฝะดั - Machine Learning Engineer

๐ง Email: alexandrtarasov1996@gmail.com

๐ฑ Telegram: @sasha4828

